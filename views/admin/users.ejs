<section class="admin-users">
  <div class="container" style="max-width:1200px;margin:30px auto;">
    <h2>Users Management</h2>
    <p><a href="/admin/users/new" class="btn btn-primary">Create new user</a></p>
    <table style="width:100%;border-collapse:collapse;">
      <thead>
        <tr style="background:#f5f5f5;"><th style="padding:8px;border:1px solid #ddd">Name</th><th style="padding:8px;border:1px solid #ddd">Email</th><th style="padding:8px;border:1px solid #ddd">Role</th><th style="padding:8px;border:1px solid #ddd">State</th><th style="padding:8px;border:1px solid #ddd">Districts</th><th style="padding:8px;border:1px solid #ddd">Active</th><th style="padding:8px;border:1px solid #ddd">Actions</th></tr>
      </thead>
      <tbody>
        <% users.forEach(u => { %>
          <tr>
            <td style="padding:8px;border:1px solid #ddd"><%= u.name %></td>
            <td style="padding:8px;border:1px solid #ddd"><%= u.email %></td>
            <td style="padding:8px;border:1px solid #ddd">
              <span style="background:<%= u.role === 'superadmin' ? '#dc3545' : '#007bff' %>;color:white;padding:3px 8px;border-radius:3px;font-size:0.85em;">
                <%= u.role %>
              </span>
            </td>
            <td style="padding:8px;border:1px solid #ddd"><%= u.state || '-' %></td>
            <td style="padding:8px;border:1px solid #ddd"><%= (u.districts && u.districts.join(', ')) || '-' %></td>
            <td style="padding:8px;border:1px solid #ddd"><%= u.active ? 'âœ… Yes' : 'âŒ No' %></td>
            <td style="padding:8px;border:1px solid #ddd;">
              <a href="/admin/users/<%= u._id %>/edit" style="color:#007bff;text-decoration:none;margin-right:10px;">âœï¸ Edit</a>
              <% if (currentUser && currentUser.role === 'superadmin') { %>
                <form method="POST" action="/admin/users/<%= u._id %>/delete" style="display:inline;" onsubmit="return confirm('âš ï¸ Are you sure you want to delete <%= u.name %>? This action cannot be undone.');">
                  <button type="submit" style="color:#dc3545;background:none;border:none;cursor:pointer;text-decoration:underline;">ğŸ—‘ï¸ Delete</button>
                </form>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</section>